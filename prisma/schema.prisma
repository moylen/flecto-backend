generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  user
  admin
}

model User {
  id               Int                @id @default(autoincrement())
  username         String             @unique
  email            String?            @unique
  passwordHash     String
  role             UserRole           @default(user)
  name             String?
  surname          String?
  description      String?
  // avatar ref to file
  createTime       DateTime           @default(now())
  updateTime       DateTime           @updatedAt
  deleteTime       DateTime?
  UserToken        UserToken[]
  UserEmailConfirm UserEmailConfirm[]
  UserContact      UserContact[]

  @@map("user")
}

model UserContact {
  id         Int      @id @default(autoincrement())
  userId     Int
  title      String
  link       String
  createTime DateTime @default(now())
  updateTime DateTime @updatedAt
  user       User     @relation(fields: [userId], references: [id])

  @@map("user_contact")
}

model UserToken {
  id           Int      @id @default(autoincrement())
  user         User     @relation(fields: [userId], references: [id])
  userId       Int
  refreshToken String   @unique
  expireTime   DateTime
  createTime   DateTime @default(now())

  @@map("user_token")
}

model UserEmailConfirm {
  id         Int      @id @default(autoincrement())
  userId     Int
  newEmail   String
  code       String
  isActive   Boolean  @default(true)
  expireTime DateTime
  createTime DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id])

  @@map("user_email_confirm")
}
